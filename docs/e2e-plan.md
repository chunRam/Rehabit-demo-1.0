# Rehabit Mobile E2E Test Plan

이 문서는 온보딩부터 감정 기반 통찰 화면까지의 핵심 흐름을 검증하기 위한 기본 E2E 시나리오와 장비/환경 전략을 정리합니다.

## 1. 테스트 환경 전략

- **플랫폼**: iOS (iPhone 14), Android (Pixel 7) 실기기 및 Expo Go 최신 버전.
- **빌드 채널**: 개발 단계에서는 Expo Dev Client, QA 단계에서는 EAS Build Preview 채널 활용.
- **데이터**: NestJS API 스테이징 인스턴스(`/habits`, `/habits/emotions`)를 사용하되, 실패 시 로컬 목 데이터 경로 확인.
- **계정/설정**: QA용 테스트 계정 1개, 온보딩 완료 플래그 초기화 스크립트 제공 예정.

## 2. 주요 시나리오

### 시나리오 A — 온보딩 플로우
1. 앱 최초 실행 시 온보딩 캐러셀 3단계가 노출되는지 확인한다.
2. 각 단계에서 "Next" 버튼을 눌러 이동할 수 있는지, 마지막 단계에서 "Start tracking" 버튼이 보이는지 확인한다.
3. 완료 화면에서 "Go to dashboard" 버튼을 탭하면 홈 탭으로 진입하고, 이후 재실행 시 온보딩이 스킵되는지 확인한다.

### 시나리오 B — 습관 생성 및 목록 반영
1. 홈 탭에서 "새 습관 만들기" 버튼을 눌러 폼 화면으로 이동한다.
2. 이름/설명/빈도를 입력하고 저장 시 홈 목록에 카드가 추가되는지 확인한다.
3. API 응답이 지연될 경우 로딩 인디케이터가 표시되는지, 실패 시 로컬 데이터가 유지되는지 확인한다.

### 시나리오 C — 감정 기록 및 성공률 업데이트
1. 홈에서 특정 습관 카드의 "Log Emotion"을 눌러 감정 입력 화면으로 이동한다.
2. 감정을 선택하고 메모, 성공률을 입력한 후 저장하면 성공률이 갱신되는지 확인한다.
3. 습관 상세 화면에서 새로운 로그가 리스트 최상단에 노출되는지 확인한다.

### 시나리오 D — 감정 리포트 확인
1. 하단 탭에서 "감정 리포트" 탭으로 이동한다.
2. 감정-성공률 차트가 최근 로그를 기준으로 렌더링되는지 확인한다.
3. 로그가 부족한 경우 안내 문구가 노출되는지 확인한다.

## 3. 회귀 테스트 체크리스트

- 온보딩 완료 상태에서 앱 재시작 시 홈으로 바로 진입하는지.
- 습관 삭제 후 목록과 차트에서 관련 데이터가 제거되는지.
- API 서버 장애 시 로컬 목 데이터가 정상적으로 대체되는지.
- 다크/라이트 테마 전환 시 색상 토큰이 올바르게 적용되는지.

## 4. 향후 계획

- Detox + Expo Dev Client 조합으로 CI 연동(안드로이드 우선) 파일럿.
- 감정/성공률 지표 스냅샷 테스트를 위한 mock server(worker) 준비.
- 다국어(i18n) 적용 시 온보딩 텍스트 및 버튼 번역 검증 절차 추가.
